<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>News loop</title>
    <style>
      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
        font-family: Calibri, "Trebuchet MS", sans-serif;
      }

      :root {
        --primary: red;
        --secondary: blue;
        --tertiary: white;
      }

      body {
        background-color: var(--tertiary);
        margin-left: 30px;
      }

      ul {
        overflow: auto;
        height: 300px;
        width: 50%;
        padding: 5px;
        border: 2px solid blue;
      }

      ul li {
        margin: 5px;
        padding: 2px;
        border-bottom: 2px solid green;
      }
    </style>
  </head>
  <body>
    <main>
      <section class="newsfeeder">
        <div class="newsList">
          <ul id="newsItem"></ul>
        </div>
      </section>
    </main>

    <script>
      myNewsFeed = () => {
        const url = "roads.xml";
        fetch(url)
          .then((response) => response.text())
          .then((data) => {
            let parser = new DOMParser();
            let road = parser.parseFromString(data, "application/xml");
            showMe(road);
          });
      };

      document.addEventListener("DOMContentLoaded", myNewsFeed);

      // 1st function
      function showMe(displayRoad) {
        //console.log(displayRoad);
        let newsItem = document.getElementById("newsItem");
        let rssItem = displayRoad.getElementsByTagName("item");
        let itemNumber = displayRoad.getElementsByTagName("item").length;

        //console.log(itemNumber);

        if (itemNumber == 0) {
          newsItem.innerHTML = `<li><h3>No News Update Available</h3></li>`;

          setTimeout(() => {
            myNewsFeed();
          }, 7000);
        } else {
          for (let i = 0; i < itemNumber; i++) {
            let li = document.createElement("li");
            li.className = "showingList";
            li.innerHTML = `
                <h3>${
                  rssItem[i].getElementsByTagName("title")[0].innerHTML
                }</h3>
                <p>${
                  rssItem[i].getElementsByTagName("description")[0].innerHTML
                }</p>
                `;

            newsItem.appendChild(li);
          }
        }
        setTimeout(() => {
          startSlidding(rssItem);
        }, 7000);
      }

      // 3nd function

      startSlidding = (viewRss) => {
        //console.log(viewRss);
        let removeList = document.getElementsByClassName("showingList");

        for (let i = 0; i < viewRss.length; i++) {
          setTimeout(() => {
            removeList[0].remove();

            if (i == viewRss.length - 1) {
              myNewsFeed();
            }
            // reload the news feed for update
          }, i * 5000);
        }
      };
    </script>
  </body>
</html>
